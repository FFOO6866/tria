# =============================================================================
# TRIA AI-BPO ENVIRONMENT CONFIGURATION
# =============================================================================
# This is a template file. To use it:
#   1. Copy this file: cp .env.unified.example .env
#   2. Fill in all values (especially those marked REQUIRED)
#   3. NEVER commit .env to git (it contains secrets!)
#
# Docker Compose automatically reads this file when you run:
#   docker-compose up -d
#
# NO need to pass variables manually on command line!
# =============================================================================

# =============================================================================
# DEPLOYMENT CONFIGURATION (Used by deploy_agent.py)
# =============================================================================

# AWS EC2 instance details
SERVER_IP=13.54.39.187
SERVER_USER=ubuntu
PEM_KEY_PATH=C:\Users\fujif\Downloads\tria.pem
SERVER_PROJECT_PATH=/home/ubuntu/tria

# Environment mode: 'development' or 'production'
# - development: Verbose logging, sample data, demo features
# - production:  Production logging, real data, security hardened
ENVIRONMENT=production

# =============================================================================
# DEPLOYMENT SIZE CONFIGURATION (Controls resource allocation)
# =============================================================================

# Instance size: 'small' or 'medium'
# - small:  t3.small (2GB RAM)  - Backend only (no frontend/nginx)
# - medium: t3.medium (4GB RAM) - Full stack (frontend + nginx)
DEPLOYMENT_SIZE=small

# Memory settings (auto-configured based on DEPLOYMENT_SIZE)
# For small (2GB):
POSTGRES_SHARED_BUFFERS=128MB
POSTGRES_EFFECTIVE_CACHE_SIZE=256MB
POSTGRES_WORK_MEM=4MB
POSTGRES_MAINTENANCE_WORK_MEM=64MB
REDIS_MAX_MEMORY=200mb
GUNICORN_WORKERS=2
GUNICORN_THREADS=2
BACKEND_START_PERIOD=60s

# For medium (4GB):
# POSTGRES_SHARED_BUFFERS=256MB
# POSTGRES_EFFECTIVE_CACHE_SIZE=512MB
# POSTGRES_WORK_MEM=16MB
# POSTGRES_MAINTENANCE_WORK_MEM=128MB
# REDIS_MAX_MEMORY=512mb
# GUNICORN_WORKERS=4
# GUNICORN_THREADS=4
# BACKEND_START_PERIOD=40s

# =============================================================================
# DATABASE CONFIGURATION (REQUIRED)
# =============================================================================

# PostgreSQL credentials
# SECURITY: Generate strong password: openssl rand -base64 32
POSTGRES_USER=tria_admin
POSTGRES_PASSWORD=
POSTGRES_DB=tria_aibpo

# Database connection pool settings
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20

# =============================================================================
# REDIS CONFIGURATION (REQUIRED)
# =============================================================================

# Redis password
# SECURITY: Generate strong password: openssl rand -base64 32
REDIS_PASSWORD=

# =============================================================================
# OPENAI API CONFIGURATION (REQUIRED - CRITICAL)
# =============================================================================

# OpenAI API key
# Get from: https://platform.openai.com/api-keys
# CRITICAL: Docker containers WILL FAIL without this!
OPENAI_API_KEY=

# OpenAI model settings
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=2000

# =============================================================================
# XERO API CONFIGURATION (OPTIONAL)
# =============================================================================

# Xero OAuth 2.0 credentials
# Get from: https://developer.xero.com/
# Leave empty if not using Xero integration
XERO_CLIENT_ID=
XERO_CLIENT_SECRET=
XERO_TENANT_ID=
XERO_REFRESH_TOKEN=

# Xero API settings
XERO_TOKEN_URL=https://identity.xero.com/connect/token
XERO_API_URL=https://api.xero.com/api.xro/2.0
XERO_RATE_LIMIT_PER_MINUTE=60

# =============================================================================
# BUSINESS CONFIGURATION (REQUIRED)
# =============================================================================

# Tax rate (Singapore GST)
# CRITICAL: This must be accurate for invoicing
TAX_RATE=0.08

# Xero account codes
# Get from Xero: Settings > Chart of Accounts
XERO_SALES_ACCOUNT_CODE=200
XERO_TAX_TYPE=TAX001

# Order processing
CUTOFF_TIME=14:00
ANOMALY_TOLERANCE=0.15
DEFAULT_DELIVERY_DAYS=2
DELIVERY_SLOTS=08:00-10:00,10:00-12:00,14:00-16:00,16:00-18:00

# =============================================================================
# SECURITY (REQUIRED)
# =============================================================================

# Secret key for session encryption and JWT signing
# SECURITY: Generate with: openssl rand -hex 32
# CRITICAL: Use different key for each environment!
SECRET_KEY=

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8003

# =============================================================================
# VALIDATION LIMITS (REQUIRED)
# =============================================================================

# Order validation thresholds
MAX_QUANTITY_PER_ITEM=10000
MAX_ORDER_TOTAL=100000.00
MAX_LINE_ITEMS=100
MIN_ORDER_TOTAL=0.01

# =============================================================================
# PORT CONFIGURATION (Optional - Use defaults if no conflicts)
# =============================================================================

# Backend API port (default: 8003)
BACKEND_PORT=8003

# Frontend port (default: 3000) - Only for medium deployments
FRONTEND_PORT=3000

# Nginx ports (default: 80/443) - Only for medium deployments
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# Redis port (default: 6379)
REDIS_PORT=6379

# PostgreSQL port (default: 5433 to avoid conflict with local postgres)
POSTGRES_PORT=5433

# =============================================================================
# MONITORING & LOGGING (OPTIONAL)
# =============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Sentry error tracking (optional)
# Get DSN from: https://sentry.io/
SENTRY_DSN=

# =============================================================================
# FILE PATHS (Optional - Use defaults)
# =============================================================================

# Excel file paths (relative to project root)
MASTER_INVENTORY_FILE=./data/inventory/Master_Inventory_File_2025.xlsx
DO_TEMPLATE_FILE=./data/templates/DO_Template.xlsx

# Output directories
OUTPUT_DIR=./data/generated
DO_OUTPUT_DIR=./data/generated/deliveries
INVOICE_OUTPUT_DIR=./data/generated/invoices

# =============================================================================
# DEMO CONFIGURATION (Optional)
# =============================================================================

# Demo mode settings
DEMO_MODE=false
LOAD_SAMPLE_DATA=false
ENABLE_CIRCUIT_BREAKERS=true

# =============================================================================
# API SERVER CONFIGURATION (Optional - Use defaults)
# =============================================================================

# API server settings
API_PORT=8000
API_HOST=0.0.0.0

# MCP server (if using)
MCP_PORT=3001

# Rate limiting
RATE_LIMIT_PER_MINUTE=100

# =============================================================================
# FUTURE INTEGRATIONS (OPTIONAL - Not yet implemented)
# =============================================================================

# Email notifications (SendGrid)
# SENDGRID_API_KEY=
# FROM_EMAIL=noreply@tria-aibpo.com

# SMS notifications (Twilio)
# TWILIO_ACCOUNT_SID=
# TWILIO_AUTH_TOKEN=
# TWILIO_PHONE_NUMBER=+6512345678

# WhatsApp Business API
# WHATSAPP_BUSINESS_ID=
# WHATSAPP_ACCESS_TOKEN=

# Lark integration
# LARK_APP_ID=
# LARK_APP_SECRET=

# =============================================================================
# DEPLOYMENT CHECKLIST
# =============================================================================
#
# Before deploying, ensure you have set:
#
# CRITICAL (Required for deployment):
# [ ] SERVER_IP             - Your EC2 instance IP
# [ ] SERVER_USER           - SSH username (usually 'ubuntu')
# [ ] PEM_KEY_PATH          - Path to your SSH private key
# [ ] ENVIRONMENT           - 'development' or 'production'
# [ ] DEPLOYMENT_SIZE       - 'small' or 'medium'
# [ ] POSTGRES_PASSWORD     - Strong password (openssl rand -base64 32)
# [ ] REDIS_PASSWORD        - Strong password (openssl rand -base64 32)
# [ ] OPENAI_API_KEY        - Your OpenAI API key (CRITICAL!)
# [ ] SECRET_KEY            - Strong key (openssl rand -hex 32)
# [ ] TAX_RATE              - Correct tax rate for your region
#
# RECOMMENDED (Optional but useful):
# [ ] XERO_CLIENT_ID        - If using Xero integration
# [ ] XERO_CLIENT_SECRET    - If using Xero integration
# [ ] SENTRY_DSN            - For error tracking
# [ ] CORS_ORIGINS          - Your production domain
#
# SECURITY CHECKLIST:
# [ ] All passwords are strong (32+ characters)
# [ ] Different secrets for dev/staging/production
# [ ] .env is in .gitignore (NEVER commit secrets!)
# [ ] SSH key has correct permissions (chmod 400 on Linux/Mac)
# [ ] Secrets are backed up securely
# [ ] Plan for secret rotation (every 90 days)
#
# After configuring this file:
# 1. Save as: .env
# 2. Verify it's in .gitignore
# 3. Deploy with: python scripts/deploy_agent.py
#
# =============================================================================
# DOCKER COMPOSE AUTOMATIC .env LOADING
# =============================================================================
#
# Docker Compose AUTOMATICALLY reads .env file in the same directory.
# You do NOT need to:
# - Pass variables on command line
# - Use --env-file flag (it's default)
# - Export variables in shell
#
# When you run: docker-compose up -d
# Docker Compose will:
# 1. Look for .env in same directory
# 2. Load all variables
# 3. Substitute ${VAR} in docker-compose.yml
# 4. Pass to containers automatically
#
# This means ONE command deployment:
#   python scripts/deploy_agent.py
#
# That's it! No manual environment variable passing needed.
# =============================================================================
